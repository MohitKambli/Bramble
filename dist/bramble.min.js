!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Bramble=t():e.Bramble=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new AudioContext;r.createOscillator(),r.createGain();t.default={decode:function(e){return new Promise((function(t,n){r.decodeAudioData(e).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},play:function(e){var t=r.createBufferSource();t.buffer=e,t.connect(r.destination),t.start()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);function o(e,t){a(e,0,0,e.canvas.width,e.canvas.height,{fill:{colour:t}})}function i(e,t,n,r,o){void 0===o&&(o=u),a(e,t,n,r,r,o)}var u={fill:{colour:"#ffffff",opacity:1},line:{width:2,colour:"#000000",opacity:1}};function a(e,t,n,r,o,i){void 0===i&&(i=u),void 0!==i.fill&&(e.fillStyle=i.fill.colour,e.fillRect(t,n,r,o)),void 0!==i.line&&(e.strokeStyle=i.line.colour,e.lineWidth=i.line.width,e.strokeRect(t,n,r,o))}var l={width:2,colour:"#000000"};function c(e,t,n,r){void 0===r&&(r=l),e.strokeStyle=r.colour,e.lineWidth=r.width,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.stroke()}var f={fill:{colour:"#000000",opacity:1},line:{colour:"#ffffff",opacity:1,width:2}};function d(e,t,n,r,o){void 0===o&&(o=f),void 0!==o.fill&&(e.fillStyle=o.fill.colour),e.beginPath(),e.strokeStyle=o.line.colour,e.lineWidth=o.line.width,e.arc(t,n,r,0,2*Math.PI),e.closePath(),void 0!==o.fill&&e.fill(),e.stroke()}function s(e,t,n,r,o,i){e.drawImage(i,t,n,r,o)}function v(e,t,n,r,o,i,u,a,l,c){e.drawImage(c,i,u,a,l,t,n,r,o)}function h(e,t){var n=t.width/2,o=t.height/2;e.save(),e.translate(t.x+n,t.y+o),e.rotate(r.default.toRadians(t.rotation)),t.frames.length>1?v(e,-n,-o,t.width,t.height,t.frames[t.frame].x,t.frames[t.frame].y,t.frames[t.frame].width,t.frames[t.frame].height,t.texture):s(e,-n,-o,t.width,t.height,t.texture),e.restore()}function p(e,t,n,r,o,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=""),void 0===o&&(o="#000000"),void 0===i&&(i="16pt sans-serif"),e.fillStyle=o,e.font=i,e.textAlign="left",e.textBaseline="top",e.fillText(r,t,n)}function y(e,t){e.fillStyle="#ffffff",e.font="16pt sans-serif",e.textAlign="left",e.textBaseline="top",e.measureText(t.text).width>t.width&&(t.text=t.text.substr(0,10)+"\n"+t.text.substr(10)),e.fillText(t.text,t.x,t.y)}function g(e,t,n,r,o,i,u,a){for(var l=1,c=2,f=4,d=8,s=16,h=32,p=64,y=128,g=function(u){for(var a=function(a){if(0===r[u][a])return"continue";var g=u>0?r[u-1][a-1]:0,m=u>0?r[u-1][a]:0,b=u>0?r[u-1][a+1]:0,x=r[u][a-1],w=r[u][a],P=r[u][a+1],O=u<r.length-1?r[u+1][a-1]:0,j=u<r.length-1?r[u+1][a]:0,_=u<r.length-1?r[u+1][a+1]:0,S=l*(w===m&&w===x&&w===g?1:0)+c*(w===m?1:0)+f*(w===m&&w===P&&w===b?1:0)+d*(w===P?1:0)+s*(w===j&&w===P&&w===_?1:0)+h*(w===j?1:0)+p*(w===j&&w===x&&w===O?1:0)+y*(w===x?1:0),M=o.filter((function(e){return e.type===r[u][a]}))[0];if(!M)return console.error("Sheet "+r[u][a]+" not found!"),{value:void 0};var T=M.tiles.filter((function(e){return e.type===S})),A=T[Math.floor(Math.random()*T.length)];A?function(e,t,n,r,o,i,u,a,l,c,f){v(e,t+l*(o*c),n+l*(i*f),l*c,l*f,c*u,f*a,c,f,r)}(e,t,n,M.image,a,u,A.position.x,A.position.y,i,A.size.width,A.size.height):console.log("Tile not defined "+S)},g=0;g<r[u].length;g++){var m=a(g);if("object"==typeof m)return m}},m=0;m<r.length;m++){var b=g(m);if("object"==typeof b)return b.value}}var m={shadowcolour:"#000000",shadowBlur:6,shadowOffsetX:4,shadowOffsetY:4};function b(e,t,n){void 0===n&&(n=m),e.save(),e.shadowColor=n.shadowcolour,e.shadowBlur=n.shadowBlur,e.shadowOffsetX=n.shadowOffsetX,e.shadowOffsetY=n.shadowOffsetY,t(),e.restore()}function x(e,t){e.save(),e.globalCompositeOperation="colour-dodge",t(),e.restore()}function w(e,t){e.save(),e.globalCompositeOperation="overlay",t(),e.restore()}function P(e,t,n){void 0===n&&(n=.25),e.save(),e.globalAlpha=n,t(),e.restore()}t.default={create:function(e){return{circle:function(t,n,r,o){void 0===o&&(o=f),d(e,t,n,r,o)},clear:function(t){o(e,t)},square:function(t,n,r,o){void 0===o&&(o=u),i(e,t,n,r,o)},rect:function(t,n,r,o,i){void 0===i&&(i=u),a(e,t,n,r,o,i)},image:function(t,n,r,o,i){s(e,t,n,r,o,i)},line:function(t,n,r){void 0===r&&(r=l),c(e,t,n,r)},sprite:function(t){h(e,t)},subImage:function(t,n,r,o,i,u,a,l,c){v(e,t,n,r,o,i,u,a,l,c)},text:function(t,n,r,o,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=""),void 0===o&&(o="#000000"),void 0===i&&(i="16pt sans-serif"),p(e,t,n,r,o,i)},textbox:function(t){y(e,t)},tiles:function(t,n,r,o,i,u,a){g(e,t,n,r,o,i)},shadow:function(t,n){void 0===n&&(n=m),b(e,t,n)},dodge:function(t){x(e,t)},overlay:function(t){w(e,t)},transparency:function(t,n){void 0===n&&(n=.25),P(e,t,n)}}},circle:d,clear:o,image:s,line:c,rect:a,sprite:h,square:i,subImage:v,text:p,textbox:y,tiles:g,shadow:b,dodge:x,overlay:w,transparency:P}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboard=t.mouse=void 0;var r=n(8);t.mouse={create:function(e){var t=r.default.create(e);return{start:function(){t.start()},update:function(){t.update()},getState:function(){return t.getState()}}}},t.keyboard={create:function(){console.log("keyboard input stub")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2=t.sound=t.textbox=t.sprite=t.sfx=t.music=t.mouse=t.keyboard=t.graphics=t.grid=t.game=t.assets=void 0;var r=n(4);Object.defineProperty(t,"assets",{enumerable:!0,get:function(){return r.default}});var o=n(6);Object.defineProperty(t,"game",{enumerable:!0,get:function(){return o.default}});var i=n(9);Object.defineProperty(t,"grid",{enumerable:!0,get:function(){return i.default}});var u=n(1);Object.defineProperty(t,"graphics",{enumerable:!0,get:function(){return u.default}});var a=n(2);Object.defineProperty(t,"keyboard",{enumerable:!0,get:function(){return a.keyboard}}),Object.defineProperty(t,"mouse",{enumerable:!0,get:function(){return a.mouse}});var l=n(10);Object.defineProperty(t,"music",{enumerable:!0,get:function(){return l.default}});var c=n(11);Object.defineProperty(t,"sfx",{enumerable:!0,get:function(){return c.default}});var f=n(12);Object.defineProperty(t,"sprite",{enumerable:!0,get:function(){return f.default}});var d=n(13);Object.defineProperty(t,"textbox",{enumerable:!0,get:function(){return d.default}});var s=n(0);Object.defineProperty(t,"sound",{enumerable:!0,get:function(){return s.default}});var v=n(14);Object.defineProperty(t,"vec2",{enumerable:!0,get:function(){return v.default}}),console.log("test")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadAllTerrain=t.loadTerrain=t.loadAllMusic=t.loadMusic=t.loadAllSounds=t.loadSound=t.loadAllImages=t.loadImage=t.loadAllText=t.loadString=void 0;var r=n(5),o=n(0);function i(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.addEventListener("load",(function(e){t(r.responseText)})),r.addEventListener("error",(function(e){n(e)})),r.open("GET",e),r.send()}))}function u(e){return void 0===e&&(e=[]),Promise.all(e.map((function(e){return i(e)})))}function a(e){return new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(e){t(r)})),r.addEventListener("error",(function(e){n(e)})),r.src=e}))}function l(e){return void 0===e&&(e=[]),Promise.all(e.map((function(e){return a(e)})))}function c(e){return new Promise((function(t,n){window.fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return o.default.decode(e)})).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))}function f(e){return void 0===e&&(e=[]),Promise.all(e.map((function(e){return c(e)})))}function d(e){return new Promise((function(e,t){}))}function s(e){var t;return i(e).then((function(e){return a((t=JSON.parse(e)).path)})).then((function(e){return r.default.create(t.name,t.type,e,t.tiles)}))}function v(e){return void 0===e&&(e=[]),Promise.all(e.map((function(e){return s(e)})))}t.loadString=i,t.loadAllText=u,t.loadImage=a,t.loadAllImages=l,t.loadSound=c,t.loadAllSounds=f,t.loadMusic=d,t.loadAllMusic=function(e){return void 0===e&&(e=[]),Promise.all(e.map((function(e){return d()})))},t.loadTerrain=s,t.loadAllTerrain=v,t.default={loadImage:a,loadString:i,loadAllText:u,loadAllImages:l,loadSound:c,loadAllSounds:f,loadTerrain:s,loadAllTerrain:v}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={create:function(e,t,n,r){return{name:e,type:t,image:n,tiles:r}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(2);t.default={create:function(){var e="#000000",t=null,n=null,i=document.createElement("canvas"),u=i.getContext("2d"),a=r.default.create(u);i.id="bramble-game";var l=null,c=function(){t&&t(1/60),n&&(a.clear(e),n(a)),l.update(),window.requestAnimationFrame(c)};return{setSize:function(e,t){i.width=e,i.height=t},setUpdate:function(e){t=e},setRender:function(e){n=e},setBackgroundColor:function(t){e=t},attachTo:function(e){e.appendChild(i)},disableContextMenu:function(){i.addEventListener("contextmenu",(function(e){e.preventDefault()}))},setSmoothing:function(e){void 0===e&&(e=!0),u.imageSmoothingEnabled=e},start:function(){console.log("test"),(l=o.mouse.create(i)).start(),window.requestAnimationFrame(c)},getMouseState:function(){return l.getState()}}}}},function(e,t,n){"use strict";function r(e){return e*(Math.PI/180)}function o(e){return e*(180/Math.PI)}Object.defineProperty(t,"__esModule",{value:!0}),t.toDegrees=t.toRadians=void 0,t.toRadians=r,t.toDegrees=o,t.default={toRadians:r,toDegrees:o}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.default={create:function(e){var t=function(){return{x:0,y:0,left:n(),wheel:o(),right:n()}},n=function(){return{pressed:!1,justPressed:!1,released:!1,justReleased:!1}},o=function(){var e=n();return r(r({},e),{moved:!1,direction:"up"})},i=(t(),t()),u=function(t){var n=function(t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}(t);i.x=n.x,i.y=n.y},a=function(e){switch(e.which){case 1:i.left.pressed=!0;break;case 2:i.wheel.pressed=!0;break;case 3:i.right.pressed=!0}},l=function(e){switch(e.which){case 1:i.left.pressed=!1;break;case 2:i.wheel.pressed=!1;break;case 3:i.right.pressed=!1}},c=function(e){i.wheel.moved=0!==e.deltaY,!1!==i.wheel.moved&&(i.wheel.direction=e.deltaY<0?"up":"down")};return{getState:function(){return i},start:function(){e.addEventListener("mousemove",u),e.addEventListener("mousedown",a),e.addEventListener("mouseup",l),e.addEventListener("wheel",c),i.x=e.width/2,i.y=e.height/2},update:function(){var e;i.wheel.moved=!1,e=i,Object.assign({},e)}}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e){return e.map((function(e){return e.slice()}))}Object.defineProperty(t,"__esModule",{value:!0});var i={pos:{x:0,y:0},visible:!0,divisions:4,tileWidth:8,tileHeight:8,scale:1};t.default={create:function(e,t,n){void 0===n&&(n=i),n=r(r({},i),n);var o=function(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=null);for(var r=[],o=0;o<t;o++){for(var i=[],u=0;u<e;u++)i.push(n);r.push(i)}return r}(e,t,0),u={x:n.pos.x,y:n.pos.y},a=n.visible,l=n.divisions,c=n.tileWidth;return{divisions:l,pos:u,tileHeight:n.tileHeight,tiles:o,tileWidth:c,visible:a,width:e,height:t,tileSize:n.tileWidth,scale:n.scale}},fill:function(e,t,n,r){var i=o(e);return function e(t,n,r){n!==r&&i[t.y][t.x]===n&&t.x<i[t.y].length&&t.x>=0&&t.y<i.length&&t.y>=0&&(i[t.y][t.x]=r,t.y<i.length-1&&e({x:t.x,y:t.y+1},n,r),t.y>0&&e({x:t.x,y:t.y-1},n,r),t.x<i[0].length-1&&e({x:t.x+1,y:t.y},n,r),t.x>0&&e({x:t.x-1,y:t.y},n,r))}(t,n,r),i},copyTiles:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={create:function(e,t,n,r,o,i,u){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===u&&(u="#ffffff");var a=[];return{width:n,height:r,texture:i,colour:u,frame:0,setFrames:function(e){a=e},addFrame:function(e){a.push(e)},get frames(){return a},get x(){return e},set x(t){e=t},get y(){return t},set y(e){t=e},get rotation(){return o},set rotation(e){o=e>=360?360-e:e}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={create:function(e,t,n,r,o){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=100),void 0===r&&(r=50),void 0===o&&(o=""),{x:e,y:t,width:n,height:r,text:o}}}},function(e,t,n){"use strict";function r(e,t){var n=e,i=t,u=function(){return Math.sqrt(n*n+i*i)},a=function(e){n*=e,i*=e},l=function(){var e=u();n/=e,i/=e};return{add:function(e){n+=e.x,i+=e.y},addScalar:function(e){n+=e,i+=e},clone:o,divide:function(e){n/=e.x,i/=e.y},divideScalar:function(e){n/=e,i/=e},dot:function(e){return n*e.x+i*e.y},getLength:u,getOpposite:function(e){return r(-e.x,-e.y)},getPerp:function(){return r(-i,n)},isEqualTo:function(e){return n==e.x&&i==e.y},multiply:function(e){n*=e.x,i*=e.y},multiplyScalar:a,normalise:l,setLength:function(e){l(),a(e)},subtract:function(e){n-=e.x,i-=e.y},subtractScalar:function(e){n-=e,i-=e},set x(e){n=e},get x(){return n},set y(e){i=e},get y(){return i}}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return r(e.x,e.y)};t.default={clone:o,create:r,fromDegrees:function(e){var t=e*(Math.PI/180);return r(Math.cos(t),Math.sin(t))}}}])}));