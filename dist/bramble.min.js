!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Bramble=t():e.Bramble=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/",n(n.s=1)}([function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=[],r=0;r<t;r++){for(var l=[],i=0;i<e;i++)l.push(n);o.push(l)}return o}function i(e){return e.map((function(e){return e.slice()}))}var a={pos:{x:0,y:0},visible:!0,divisions:4,tileWidth:8,tileHeight:8,scale:1};e.exports={create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a;n=o(o({},a),n);var r=l(e,t,0),i={x:n.pos.x,y:n.pos.y},c=n.visible,u=n.divisions,d=n.tileWidth,f=n.tileHeight,s=n.tileWidth,b=n.scale;return{divisions:u,pos:i,tileHeight:f,tiles:r,tileWidth:d,visible:c,width:e,height:t,tileSize:s,scale:b}},fill:function(e,t,n,o){var r=i(e);return function e(t,n,o){n!==o&&r[t.y][t.x]===n&&t.x<r[t.y].length&&t.x>=0&&t.y<r.length&&t.y>=0&&(r[t.y][t.x]=o,t.y<r.length-1&&e({x:t.x,y:t.y+1},n,o),t.y>0&&e({x:t.x,y:t.y-1},n,o),t.x<r[0].length-1&&e({x:t.x+1,y:t.y},n,o),t.x>0&&e({x:t.x-1,y:t.y},n,o))}(t,n,o),r},copyTiles:i}},function(e,t,n){"use strict";n.r(t),n.d(t,"assets",(function(){return f})),n.d(t,"game",(function(){return Z})),n.d(t,"grid",(function(){return ee.a})),n.d(t,"graphics",(function(){return O})),n.d(t,"keyboard",(function(){return U})),n.d(t,"mouse",(function(){return G})),n.d(t,"music",(function(){return te})),n.d(t,"sfx",(function(){return ne})),n.d(t,"sprite",(function(){return re})),n.d(t,"textbox",(function(){return le})),n.d(t,"sound",(function(){return l})),n.d(t,"vec2",(function(){return ce}));var o={create:function(e,t,n,o){return{name:e,type:t,image:n,tiles:o}}},r=new AudioContext;r.createOscillator(),r.createGain();var l={decode:function(e){return new Promise((function(t,n){r.decodeAudioData(e).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},play:function(e){var t=r.createBufferSource();t.buffer=e,t.connect(r.destination),t.start()}};function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise((function(n,o){var r=new XMLHttpRequest;r.responseType=t,r.addEventListener("load",(function(e){switch(t){case"text":n(e.target.responseText);break;case"json":n(e.target.response);break;default:console.error("invalid type provided to load: ".concat(t," is unknown"))}})),r.addEventListener("error",(function(e){o(e)})),r.open("GET",e,!0),r.send()}))}function a(e){return i(e,"json")}function c(e){return new Promise((function(t,n){var o=new Image;o.addEventListener("load",(function(e){t(o)})),o.addEventListener("error",(function(e){n(e)})),o.src=e}))}function u(e){return new Promise((function(t,n){window.fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return l.decode(e)})).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))}function d(e){var t=null;return a(e).then((function(e){return c((t=e).path)})).then((function(e){return o.create(t.name,t.type,e,t.tiles)})).catch((function(e){console.error(e)}))}var f={loadText:function(e){return i(e,"text")},loadJson:a,loadImage:c,loadAllText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return i(e,"text")})))},loadAllImages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return c(e)})))},loadSound:u,loadAllSounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return u(e)})))},loadTerrain:d,loadAllTerrain:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return d(e)})))}};var s={toRadians:function(e){return e*(Math.PI/180)},toDegrees:function(e){return e*(180/Math.PI)}};function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var h=null;var p={fill:{color:"#ffffff",opacity:1},line:{width:2,color:"#000000",opacity:1}};function v(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p;void 0!==r.fill&&(h.fillStyle=r.fill.color,h.fillRect(e,t,n,o)),void 0!==r.line&&(h.strokeStyle=r.line.color,h.lineWidth=r.line.width,h.strokeRect(e,t,n,o))}var g={width:2,color:"#000000"};var y={fill:{color:"#000000",opacity:1},line:{color:"#ffffff",opacity:1,width:2}};function m(e,t,n,o,r){h.drawImage(r,e,t,n,o)}function w(e,t,n,o,r,l,i,a,c){h.drawImage(c,r,l,i,a,e,t,n,o)}var x={shadowColor:"#000000",shadowBlur:6,shadowOffsetX:4,shadowOffsetY:4};var O={circle:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;void 0!==o.fill&&(h.fillStyle=o.fill.color),h.beginPath(),h.strokeStyle=o.line.color,h.lineWidth=o.line.width,h.arc(e,t,n,0,2*Math.PI),h.closePath(),void 0!==o.fill&&h.fill(),h.stroke()},clear:function(e){v(0,0,h.canvas.width,h.canvas.height,{fill:{color:e}})},image:m,line:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;h.strokeStyle=n.color,h.lineWidth=n.width,h.beginPath(),h.moveTo(e.x,e.y),h.lineTo(t.x,t.y),h.stroke()},rect:v,getContext:function(){return h},setContext:function(e){h=e},sprite:function(e){var t=e.width/2,n=e.height/2;h.save(),h.translate(e.x+t,e.y+n),h.rotate(s.toRadians(e.rotation)),e.frames.length>1?w(-t,-n,e.width,e.height,e.frames[e.frame].x,e.frames[e.frame].y,e.frames[e.frame].width,e.frames[e.frame].height,e.texture):m(-t,-n,e.width,e.height,e.texture),h.restore()},square:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p;v(e,t,n,n,o)},subImage:w,text:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000000",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"16pt sans-serif";h.fillStyle=o,h.font=r,h.textAlign="left",h.textBaseline="top",h.fillText(n,e,t)},textbox:function(e){h.fillStyle="#ffffff",h.font="16pt sans-serif",h.textAlign="left",h.textBaseline="top",h.measureText(e.text).width>e.width&&(e.text=e.text.substr(0,10)+"\n"+e.text.substr(10)),h.fillText(e.text,e.x,e.y)},tiles:function(e,t,n,o,r,l,i){for(var a=1,c=2,u=4,d=8,f=16,s=32,h=64,p=128,v=function(l){for(var i=function(i){if(0===n[l][i])return"continue";var b=l>0?n[l-1][i-1]:0,v=l>0?n[l-1][i]:0,g=l>0?n[l-1][i+1]:0,y=n[l][i-1],m=n[l][i],x=n[l][i+1],O=l<n.length-1?n[l+1][i-1]:0,j=l<n.length-1?n[l+1][i]:0,P=l<n.length-1?n[l+1][i+1]:0,S=a*(m===v&&m===y&&m===b?1:0)+c*(m===v?1:0)+u*(m===v&&m===x&&m===g?1:0)+d*(m===x?1:0)+f*(m===j&&m===x&&m===P?1:0)+s*(m===j?1:0)+h*(m===j&&m===y&&m===O?1:0)+p*(m===y?1:0),k=o.filter((function(e){return e.type===n[l][i]}))[0];if(!k)return console.error("Sheet ".concat(n[l][i]," not found!")),{v:{v:void 0}};var E=k.tiles.filter((function(e){return e.type===S})),T=E[Math.floor(Math.random()*E.length)];T?function(e,t,n,o,r,l,i,a,c,u){w(e+a*(o*c),t+a*(r*u),a*c,a*u,c*l,u*i,c,u,n)}(e,t,k.image,i,l,T.position.x,T.position.y,r,T.size.width,T.size.height):console.log("Tile not defined ".concat(S))},v=0;v<n[l].length;v++){var g=i(v);if("continue"!==g&&"object"===b(g))return g.v}},g=0;g<n.length;g++){var y=v(g);if("object"===b(y))return y.v}},shadow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x;h.save(),h.shadowColor=t.shadowColor,h.shadowBlur=t.shadowBlur,h.shadowOffsetX=t.shadowOffsetX,h.shadowOffsetY=t.shadowOffsetY,e(),h.restore()},dodge:function(e){h.save(),h.globalCompositeOperation="color-dodge",e(),h.restore()},overlay:function(e){h.save(),h.globalCompositeOperation="overlay",e(),h.restore()},transparency:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;h.save(),h.globalAlpha=t,e(),h.restore()}},j=document.createElement("canvas");j.id="bramble-game";var P=j.getContext("2d");var S={element:j,setSize:function(e,t){j.width=e,j.height=t},attachTo:function(e){e.appendChild(j),O.setContext(P)},setSmoothing:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];P.imageSmoothingEnabled=e},disableContextMenu:function(){j.addEventListener("contextmenu",(function(e){e.preventDefault()}))}};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D,C=(D={pressed:!1,justPressed:!1,released:!1,justReleased:!1},[{code:8,label:"backspace"},{code:9,label:"tab"},{code:13,label:"enter"},{code:16,label:"shift"},{code:17,label:"ctrl"},{code:18,label:"alt"},{code:20,label:"caps"},{code:27,label:"escape"},{code:32,label:"space"},{code:33,label:"pageUp"},{code:34,label:"pageDown"},{code:35,label:"end"},{code:36,label:"home"},{code:37,label:"left"},{code:38,label:"up"},{code:39,label:"right"},{code:40,label:"down"},{code:45,label:"insert"},{code:46,label:"delete"},{code:48,label:"zero"},{code:49,label:"one"},{code:50,label:"two"},{code:51,label:"three"},{code:52,label:"four"},{code:53,label:"five"},{code:54,label:"six"},{code:55,label:"seven"},{code:56,label:"eight"},{code:57,label:"nine"},{code:65,label:"A"},{code:66,label:"B"},{code:67,label:"C"},{code:68,label:"D"},{code:69,label:"E"},{code:70,label:"F"},{code:71,label:"G"},{code:72,label:"H"},{code:73,label:"I"},{code:74,label:"J"},{code:75,label:"K"},{code:76,label:"L"},{code:77,label:"M"},{code:78,label:"N"},{code:79,label:"O"},{code:80,label:"P"},{code:81,label:"Q"},{code:82,label:"R"},{code:83,label:"S"},{code:84,label:"T"},{code:85,label:"U"},{code:86,label:"V"},{code:87,label:"W"},{code:88,label:"X"},{code:89,label:"Y"},{code:90,label:"Z"},{code:91,label:"superLeft"},{code:92,label:"superRight"},{code:93,label:"select"},{code:96,label:"num0"},{code:97,label:"num1"},{code:98,label:"num2"},{code:99,label:"num3"},{code:100,label:"num4"},{code:101,label:"num5"},{code:102,label:"num6"},{code:103,label:"num7"},{code:104,label:"num8"},{code:105,label:"num9"},{code:106,label:"multiply"},{code:107,label:"add"},{code:109,label:"subtract"},{code:110,label:"point"},{code:111,label:"divide"},{code:112,label:"F1"},{code:113,label:"F2"},{code:114,label:"F3"},{code:115,label:"F4"},{code:116,label:"F5"},{code:117,label:"F6"},{code:118,label:"F7"},{code:119,label:"F8"},{code:120,label:"F9"},{code:121,label:"F10"},{code:122,label:"F11"},{code:123,label:"F12"},{code:144,label:"numLock"},{code:145,label:"scrollLock"},{code:186,label:"semiColon"},{code:187,label:"equals"},{code:188,label:"comma"},{code:189,label:"dash"},{code:190,label:"dot"},{code:191,label:"forewardSlash"},{code:192,label:"graveAccent"},{code:219,label:"openBracket"},{code:220,label:"backSlash"},{code:221,label:"closeBracket"},{code:222,label:"singleQuote"}].reduce((function(e,t){var n=t.label;return delete t.label,e[n]=E(E({},t),D),e}),{}));function L(e,t){for(var n=null,o=Object.keys(t),r=0;r<o.length;r++)t[o[r]].code===e.keyCode&&(n=t[o[r]]);return n}function M(e){!function(e){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.preventDefault()}(e),L(e,C).pressed=!0}function A(e){L(e,C).pressed=!1}var F={start:function(){document.addEventListener("keydown",M),document.addEventListener("keyup",A)},update:function(){},state:C};function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}q();var W=q();function q(){return{x:0,y:0,left:{pressed:!1,justPressed:!1,released:!1,justReleased:!1},wheel:R(R({},{pressed:!1,justPressed:!1,released:!1,justReleased:!1}),{},{moved:!1}),right:{pressed:!1,justPressed:!1,released:!1,justReleased:!1}}}function z(e){var t=function(e,t){var n=j.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}(e);W.x=t.x,W.y=t.y}function X(e){switch(e.which){case 1:W.left.pressed=!0;break;case 2:W.middle.pressed=!0;break;case 3:W.right.pressed=!0}}function Y(e){switch(e.which){case 1:W.left.pressed=!1;break;case 2:W.middle.pressed=!1;break;case 3:W.right.pressed=!1}}function _(e){W.wheel.moved=0!==e.delta,!1!==W.wheel.moved&&(W.wheel.direction=e.deltaY<0?"up":"down")}var H={start:function(){j.addEventListener("mousemove",z),j.addEventListener("mousedown",X),j.addEventListener("mouseup",Y),j.addEventListener("wheel",_),W.x=j.width/2,W.y=j.height/2},update:function(){var e;W.wheel.moved=!1,e=W,Object.assign({},e)},state:W};var U=F.state,G=H.state,J={start:function(){F.start(),H.start()},update:function(){F.update(),H.update()}},Q="#000000",K=null,N=null;function V(){K&&K(1/60),N&&(O.clear(Q),N()),J.update(),window.requestAnimationFrame(V)}var Z={setSize:S.setSize,setUpdate:function(e){K=e},setRender:function(e){N=e},setBackgroundColor:function(e){Q=e},attachTo:S.attachTo,disableContextMenu:S.disableContextMenu,setSmoothing:S.setSmoothing,start:function(){J.start(),window.requestAnimationFrame(V)}},$=n(0),ee=n.n($),te={},ne={};function oe(e,t){for(var n in t){(l=t[n]).configurable=l.enumerable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,n,l)}if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(t),r=0;r<o.length;r++){var l,i=o[r];(l=t[i]).configurable=l.enumerable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,i,l)}return e}var re={create:function(){var e,t,n,o,r,l,i,a,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,b=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#ffffff",p=[];return i={x:c,y:u,width:d,height:f,rotation:s,texture:b,color:h,frame:0,setFrames:function(e){p=e},addFrame:function(e){p.push(e)},get frames(){return p}},(a={})[e="x"]=a[e]||{},a[e].get=function(){return c},a[t="x"]=a[t]||{},a[t].set=function(e){c=e},a[n="y"]=a[n]||{},a[n].get=function(){return u},a[o="y"]=a[o]||{},a[o].set=function(e){u=e},a[r="rotation"]=a[r]||{},a[r].get=function(){return s},a[l="rotation"]=a[l]||{},a[l].set=function(e){s=e>=360?360-e:e},oe(i,a),i}};var le={create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{x:e,y:t,width:n,height:o,text:r}}};function ie(e,t){var n=e,o=t,r=function(){return Math.sqrt(n*n+o*o)},l=function(e){n*=e,o*=e},i=function(){var e=r();n/=e,o/=e};return{add:function(e){n+=e.x,o+=e.y},addScalar:function(e){n+=e,o+=e},clone:ae,divide:function(e){n/=e.x,o/=e.y},divideScalar:function(e){n/=e,o/=e},dot:function(e){return n*e.x+o*e.y},getLength:r,getOpposite:function(e){return ie(-e.x,-e.y)},getPerp:function(){return ie(-o,n)},isEqualTo:function(e){return n==e.x&&o==e.y},multiply:function(e){n*=e.x,o*=e.y},multiplyScalar:l,normalise:i,setLength:function(e){i(),l(e)},subtract:function(e){n-=e.x,o-=e.y},subtractScalar:function(e){n-=e,o-=e},set x(e){n=e},get x(){return n},set y(e){o=e},get y(){return o}}}var ae=function(e){return ie(e.x,e.y)},ce={clone:ae,create:ie,fromDegrees:function(e){var t=e*(Math.PI/180);return ie(Math.cos(t),Math.sin(t))}}}])}));